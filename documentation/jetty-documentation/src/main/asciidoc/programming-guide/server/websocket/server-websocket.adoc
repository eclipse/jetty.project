//
// ========================================================================
// Copyright (c) 1995-2021 Mort Bay Consulting Pty Ltd and others.
//
// This program and the accompanying materials are made available under the
// terms of the Eclipse Public License v. 2.0 which is available at
// https://www.eclipse.org/legal/epl-2.0, or the Apache License, Version 2.0
// which is available at https://www.apache.org/licenses/LICENSE-2.0.
//
// SPDX-License-Identifier: EPL-2.0 OR Apache-2.0
// ========================================================================
//

[[pg-server-websocket]]
=== WebSocket Server

// JettyWebSocketServletContainerInitializer.configure(ServletContextHandler context, Configurator configurator); is one entry point.

// JettyWebSocketServlet.configure(JettyWebSocketServletFactory factory); another entry point.

// TODO: why they expose different interfaces? Configurator exposes JettyWebSocketServerContainer, the servlet exposes JettyWebSocketServletFactory => historical, live with it.

// WSUFilter is automatically added lazily when context is started or when calling addMapping().
// Talk about WSUF but in the context of the upgrade, not much as an API to use, only init-params.
// WSUF init-params will however configure both Jetty and Javax containers.
// WSUF has a specific name in web.xml if you want to provide a WSUF that has a different config, e.g. different mapping than /*, or different init-params.

// For Javax I can pass in an HttpClient via ServletContext attribute.
// Also describe the XML file for HttpClient => needed to avoid class loader issues?

// WSUF and Servlet are typically mutually exclusive.
// However, WSUF could be mapped to /foo and servlet to /bar; OR
// WSUF has a mapping for /ep1 and Servlet has a mapping for /ep2, so an upgrade request enters WSUF, finds no mapping, forwards, lands to Servlet where the mapping is found.
